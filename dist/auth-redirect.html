<!DOCTYPE html>
<html>
<head>
  <script src="https://alcdn.msauth.net/browser/2.28.1/js/msal-browser.min.js"></script>
  <script>
    const msalConfig = {  
      auth: {
        clientId: "2aa8453b-2c60-4d91-baeb-8a920b648453",
        authority: "https://login.microsoftonline.com/3dfe125d-a589-44af-9fc7-113f3bff5873",
        navigateToLoginRequestUrl: false
      },
      cache: {
        cacheLocation: "localStorage", 
        storeAuthStateInCookie: false
        }
    };
    const msalInstance = new msal.PublicClientApplication(msalConfig);

    msalInstance.handleRedirectPromise()
      .then((resp) => {
        // pop the token back to the opener, if needed
        if (resp && window.opener) {
          window.opener.postMessage({ authResponse: resp }, window.location.origin);
        }
      })
      .catch(console.error)
      .finally(() => {
        window.close();
      });
  </script>
</head>
<body></body>
</html>
